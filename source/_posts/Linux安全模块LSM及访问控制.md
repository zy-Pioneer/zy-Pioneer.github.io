---
title: Linux安全模块LSM及访问控制
date: 2024-12-15
updated: 2024-12-15
tags: [安全]
categories: [信息系统安全课程复习]
---

操作系统安全以**访问控制**为核心，与**硬件结构安全**一同构成信息系统安全的基础，在计算机信息系统的整体安全性中具有至关重要的作用。

访问控制机制的理论基础是引用监视器（也叫做参照监控器，reference monitor），引用监视器位于内核空间中，所有用户空间中的应用进程在进行系统调用时都必须经过引用监视器的安全检查，再去调用内核空间中的资源。引用监视器必须具有自我保护能力、总是处于活跃状态、设计得足够小，以利于分析和测试。

安全内核是指系统中与安全性实现有关的部分，包括引用验证机制、访问控制机制、授权机制和授权管理机制等，三条基本原则为：

1. 完整性原则：主体引用客体时必须通过安全内核
2. 隔离性原则：安全内核具有防篡改能力
3. 可验证性原则：接口简单、内核小等

MAC（Mandatory Access Control，强制访问控制）是一种由系统强制执行的安全策略，通过预定义的规则对资源访问进行限制。MAC基于主体（用户或进程）和客体（文件或资源）的安全标签，以及系统管理员设定的策略来决定是否允许访问。用户无法更改权限设置，确保了高度安全性，因此常用于军事、政府和金融等高安全性需求的场景。

DAC（Discretionary Access Control，自主访问控制）是一种由资源所有者控制访问权限的安全模型。资源的所有者可以根据需要自由设置访问权限，例如读、写、执行权限。DAC机制灵活且易于使用，但由于其依赖于用户设置，存在一定的安全漏洞，适用于普通用户环境和企业级应用场景。

## Linux安全模块LSM简介
 Linux安全模块（LSM，Linux Security Modules）是Linux内核中的一个安全框架，旨在为不同的安全模型（如SELinux、AppArmor）提供统一的接口和基础设施。通过在内核关键代码路径中插入安全钩子（hooks），LSM允许安全模块实现访问控制、权限管理和资源保护等功能，从而增强系统的安全性和灵活性。  

Linux 安全模块（LSM）为增强 Linux 系统的安全性提供了统一的轻量级的访问控制框架，通过安全钩子和模块化设计，使得各种访问控制模型能够在内核中实现。用户在执行系统调用时，先通过内核接口找到对应的系统调用，接着定位目标节点，然后执行错误检查判断是否存在或损坏，然后执行自主访问控制 DAC 检查，判断访问权限是否满足，再通过 LSM 钩子执行对应的内核安全模块的检查逻辑，再上述检查无误的情况下执行对应的功能。

##  基于LSM的访问控制机制
LSM框架下的访问策略包括selinux，smack，tomoyo，yama 用户还可以注册自己的钩子函数，注册到LSM框架的模块被加载成功后，就可以进行访问控制。LSM通过在内核源代码中放置钩子函数的方法，来仲裁对内核内部对象进行的访问，实现了相关钩子函数就可以实现访问控制。LSM 钩子函数通常放在内核自主访问控制后，在内核进行真正内部资源访问前。也就是说，经过了自主访问控制的检查，还需要经过LSM 钩子函数的判定，才能访问到资源。

## LSM在信息系统安全中的作用
Linux安全模块（LSM，Linux Security Modules）在信息系统安全中的作用主要体现在以下几个方面：

1. **统一安全框架**：LSM为内核中的各种安全机制提供了一个统一的接口和框架。它允许不同的安全模块（如SELinux、AppArmor、Smack）通过挂载安全钩子（hooks）实现特定的安全策略，而无需修改内核的核心代码，提升了系统的扩展性和灵活性。
2. LSM 支持强制访问控制模型（MAC，如 SELinux、Smack 等），通过安全策略严格限制资源的访问权限。LSM 支持灵活的自主访问控制（DAC），可以结合传统的自主访问控制与更高级别的控制模型，如基于角色（RBAC）的访问控制。
3. LSM 模块通过标签化的机制对敏感文件、进程、网络连接等对象进行标记，并定义严格的访问策略。LSM 可以根据安全策略限制进程的操作，如启动子进程、加载模块、访问内存等。通过网络相关的 LSM 钩子，可以控制网络套接字的创建、绑定、发送和接收操作。LSM 模块提供丰富的日志记录功能，记录系统中所有被限制或允许的安全事件。
4. **强化访问控制：**LSM 提供了一种框架，通过它可以在操作系统级别实现增强的机制。这使得管理员可以定义和实施复杂的访问控制策略，超越了传统的基于用户理。例如，SELinux和AppArmor 等模块允许对进程、文件和其他系统资源进行乡问控制，从而减少未授权访问的风险。
5. **实现强制性安全策略：**通过使用如SELinux或Smack 这样的LSM，组织可性的安全策略，确保即使应用程序存在漏洞或者被攻破，攻击者也无法轻易地超全边界。这些策略是强制执行的，不依赖于用户的行为或配置，提供了更强的安提供隔离环境:LSM 可以帮助创建隔离的运行环境，比如通过Landlock头提供沙箱功能。这种隔离有助于限制应用程序和服务之间的相互影响，降低单个后对整个系统的潜在威胁。
6. **防止恶意软件和内核级攻击：**某些LSM如Yama 和 LoadPin 专门设计用于内核型的攻击，如防止进程间的非法交互或阻止加载未经验证的内核模块。这有效抵御恶意软件和内核级攻击的能力。
7. **简化安全管理：**虽然一些LSM 如SELinux 可能需要较为复杂的配置，AppArmor 和 Tomoyo 则以简化配置为目标，使得中小型企业或不具备专业知识也能够轻松部署和维护有效的安全策略。
8. **支持多种安全模型共存：**LSM 架构允许多个不同的安全模块同时存在，这意味着可以根据实际需求组合使用不同类型的 LSM 来满足多样化和复杂的控制，这对于构建高度定制化的安全解决方案非常有用。
9. **增强审计能力：**许多LSM不仅能够控制访问，还能记录尝试访问的系统活动、检测异常行为以及事后分析都是非常有价值的。例如，通过日志可以追踪到哪些主体尝试过访问敏感资源，以及这些尝试是否成功。



